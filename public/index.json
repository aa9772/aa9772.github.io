[{"content":"Index Overview Why Use This Simulator Features Visualization \u0026amp; Interaction Getting Started Running the Simulator Excel Configuration Why Excel? GitHub Repository License Example: Two Pistons Configuration Overview The Multi-Piston Simulator is a modular Python project designed to simulate industrial piston systems with realistic control, sensors, and fault behavior. It is aimed at engineers, researchers, and students who want to understand, test, or demonstrate automation concepts without physical hardware.\nThis simulator is particularly useful for:\nEducation: visualizing the dynamics of pistons, sensors, and commands in real time. Research \u0026amp; Development: testing PLC logic, Modbus communication, or control algorithms. Prototyping: quickly iterating piston configurations before moving to real hardware. Why Use This Simulator Safe and fast experimentation: test different piston configurations, command strategies, and faults without risk or cost. Fully configurable via Excel: change number of pistons, strokes, sensors, and control modes in seconds. Visual feedback: intuitive visualization of pistons, rods, sensors, and commands. Modular and extendable: easy to integrate PLC logic, Modbus interfaces, or new simulation features. Consistency across simulations: all pistons share the same scaling and behavior, making comparisons reliable. Fault simulation included: block pistons to test emergency response, logic handling, or PLC reaction. This makes it ideal for anyone looking to learn automation, validate control logic, or showcase industrial simulation skills.\nFeatures Multi-piston simulation with independent movement. Extend and retract commands with single or double command modes. Endstop sensors with color indicators (green = active, red = inactive). Fault simulation (blocking pistons). Labels for each piston, fully configurable via Excel. Real-time animation using Matplotlib. Optional Modbus TCP interface for external control and monitoring. Visualization \u0026amp; Interaction The simulator provides clear visual feedback for each piston:\nCylinder and rod: motion accurately reflects stroke configuration. Piston head: moves with rod to show current position. Endstop sensors: indicate whether pistons are fully retracted or extended. Command indicators: show which commands are active in real time. Fault indicators: simulate blocked pistons for testing emergency response. This makes it possible to observe control logic and physical response simultaneously, bridging the gap between theory and practice.\nGetting Started Requirements Python 3.8+ Libraries: pandas, matplotlib, openpyxl, pyModbusTCP (if using Modbus) Excel for configuration Install dependencies:\npip install pandas matplotlib openpyxl pyModbusTCP Running the Simulator Clone the repository:\ngit clone https://github.com/aa9772/piston-sim.git cd piston-sim Run the simulator with the default configuration:\npython -m piston_sim.main Or specify a custom Excel file:\npython -m piston_sim.main path_to_your_excel.xlsx Excel Configuration Pistons are fully configurable via Excel. Configure:\nColumn Description ID Piston identifier Label Displayed label above piston Stroke Maximum piston extension Sensor Retract \u0026lsquo;Yes\u0026rsquo; or \u0026lsquo;No\u0026rsquo; Sensor Extend \u0026lsquo;Yes\u0026rsquo; or \u0026lsquo;No\u0026rsquo; Single/Double Command \u0026lsquo;Single\u0026rsquo; or \u0026lsquo;Double\u0026rsquo; command mode Speed Optional, piston movement speed Why Excel? Non-technical users can change piston setup without editing code. Quick experimentation with different numbers of pistons or stroke lengths. Easily integrates with PLC and Modbus simulation logic. GitHub Repository Full source code, releases, and updates are available on GitHub:\nhttps://github.com/aa9772/piston-sim\nLicense This project is licensed under the MIT License.\nExample: Two Pistons Configuration We will simulate two pistons with different setups:\nPiston Configurations Piston A\nDouble Command Both sensors are present This piston can extend and retract independently, with full sensor feedback. Piston B\nSingle Command Only the extended sensor is present This piston only detects the extended position, limiting control options. You can see the Excel configuration file here:\nDownload Piston Configuration\nThis file contains the setup parameters for each piston, including command type and sensor presence.\nOutput of the configuration:\nDiagram showing how the pistons are configured according to the Excel file.\nModbus Master Setup We use ModbusTools as the Modbus Master:\nModbusTools\nThis software simulates a Modbus client to control the pistons.\nClient configuration file:\nDownload Client Configuration\nContains the mapping of Modbus addresses and commands for each piston.\nClient GUI Screenshot:\nShows the Modbus client interface with pistons listed and ready to be controlled.\nExecution Example: Piston A Extension This screenshot shows Piston A extending under Modbus command, verifying that sensors respond correctly.\nResult:\nGraphical output of Piston A’s motion and sensor feedback over time.\nFault Simulation Modbus Fault Simulation:\nDemonstrates a simulated Modbus fault during piston operation.\nFault Result:\nShows how the system reacts to the fault, including sensor and command status.\n","permalink":"https://andreaalessi.com/projects/piston-sim/","summary":"Modular multi‑piston simulator in Python with Excel configuration, real‑time Matplotlib visualization, and Modbus TCP interface for control and sensor simulation.","title":"Multi-Piston Simulator"}]